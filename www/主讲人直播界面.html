<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>主讲人直播界面</title>
    <link rel="stylesheet" href="weui/weui.css">
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_nmfmi65bopskmx6r.css">
    <link rel="stylesheet" href="css/jquery-weui.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery.min.js"></script>
    <script src="plugins/fastclick.min.js"></script>
    <script src="plugins/adaptive-version2.js"></script>
    <script src="weui/weui.js"></script>
    <script src="plugins/jquery-weui.js"></script>
    <script src="js/main.js"></script>
</head>
<body>
<div class="container">
    <div class="live-page-wrap">
        <div class="live-page-header">
            <img src="images/author.jpg" alt="">
            <dl>
                <dt>韩春生</dt>
                <dd>直播时间：12月13日 20:00</dd>
            </dl>
            <p>提出情感相关问题，具体描述事情的前因后果和你的 困惑，精选优质导师帮你解答。提出情感相关问题，具体描述事情的前因后果和你的 困惑，精选优质导师帮你解答。 </p>
            <a class="show-all" href="javascript:;">查看完整简介</a>
        </div>
        <div class="live-page-yq">
            <a class="btn btn-danger" href="###">我的邀请卡</a>
        </div>
        <div class="live-content-body">
            <ul class="live-detail-wrap">
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                1、恭喜你成功进入直播间，留意
                                顶部的开播时间，就在此页面观看
                                直播哦~ <br>
                                2、听不到声音请往下翻，确认有
                                语音发出，手机没有静音；拔掉耳
                                机，关闭wifi后点击语音条重试：
                                再不行退出后重新进来。<br>
                                3、点击下方输入框提问讨论。
                                4、点击我的邀请卡生成专属邀请
                                卡将直播分享给好友。
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                大家好，讲座马上开始了.
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="live-img-box">
                                <img src="images/topic.jpg" alt="">
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="ui-audio-bar">
                                <div class="ui-audio-progress">
                                    <div class="audio-progress-inner"></div>
                                </div>
                                <div class="ui-audio-data">
                                    <span>23″</span>
                                </div>
                                <a class="audio-btn" data-toggle="live-btn" href="javascript:;">
                                    <i class="iconfont icon-zanting1"></i>
                                    <audio preload="auto" src="images/636002265649091653.mp3"></audio>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="ui-audio-bar">
                                <div class="ui-audio-progress">
                                    <div class="audio-progress-inner"></div>
                                </div>
                                <div class="ui-audio-data">
                                    <span>23″</span>
                                </div>
                                <a class="audio-btn" data-toggle="live-btn" href="javascript:;">
                                    <i class="iconfont icon-zanting1"></i>
                                    <audio preload="auto" src="images/636002265649091653.mp3"></audio>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item my-live-item">
                    <div class="live-bd">
                        <div class="live-author-name">二虎子</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                这个地方是听课人在提问提问的问 题显示在这里
                            </div>
                        </div>
                    </div>
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="back-to-wrap">
    <a href="###" class="back-to-btn">回到播放位置</a>
</div>
<div class="fixed-control">
    <ul class="live-control-fixed">
        <li>
            <a href="###">
                <i class="iconfont icon-fenxiang1"></i>
                <span>分享</span>
            </a>
        </li>
        <li>
            <a href="###">
                <i class="iconfont icon-xianshiyezhikanlouzhu"></i>
                <span>只看主讲</span>
            </a>
        </li>
    </ul>
</div>
<div class="fix-btn-box ui-border-t">
    <div class="jia-reply" data-toggle="reply-btn">
        <div class="jia-reply-inner main-reply-inner">
            <input type="text" placeholder="说点什么吧~">
        </div>
        <a href="###" class="reply-btn-img">
            <i class="iconfont icon-tupian1"></i>
        </a>
        <a href="###" class="reply-btn-audio">
            <i class="iconfont icon-yuyin1"></i>
        </a>
        <div class="reply-btn-wrap">
            <a href="###" class="reply-btn">发送</a>
        </div>
    </div>
</div>

<div class="audio-publish-drop"></div>
<div class="audio-publish-wrap">
    <div class="media-wrap media-wb">
        <dl class="media-new">
            <dt>0:00</dt>
            <dd>点击开始60″录音</dd>
        </dl>
        <div class="media-c">
            <div class="media-c-a">
                <a data-toggle="close-audio-btn" href="javascript:;" class="media-re-btn">取消</a>
            </div>
            <div class="media-c-b">
                <a class="media-btn" href="javascript:;"></a>
            </div>
            <div class="media-c-c"></div>
        </div>
    </div>
    <!--<div class="media-wrap media-wb">
        <dl class="media-new">
            <dt>0:00</dt>
            <dd>录制中再次点击，停止录制</dd>
        </dl>
        <div class="media-c">
            <div class="media-c-a">
            </div>
            <div class="media-c-b">
                <a class="media-btn media-btn-ing" href="javascript:;"></a>
            </div>
            <div class="media-c-c"></div>
        </div>
    </div>-->

    <!--<div class="media-wrap media-wb">
        <dl class="media-new">
            <dt>0:54</dt>
            <dd>录音完成</dd>
        </dl>
        <div class="media-c">
            <div class="media-c-a">
                <a href="javascript:;" class="media-re-btn">重录</a>
            </div>
            <div class="media-c-b">
                <a class="media-btn media-btn-over" href="javascript:;"></a>
            </div>
            <div class="media-c-c">
                <a href="javascript:;" class="media-re-btn usable">发送</a>
            </div>
        </div>
    </div>-->


    <!--<div class="media-wrap media-wb">
        <dl class="media-new">
            <dt>0:54</dt>
            <dd>播放录音</dd>
        </dl>
        <div class="media-c">
            <div class="media-c-a">
                <a href="javascript:;" class="media-re-btn">重录</a>
            </div>
            <div class="media-c-b">
                <a class="media-btn media-btn-play" href="javascript:;"></a>
            </div>
            <div class="media-c-c">
                <a href="javascript:;" class="media-re-btn usable">发送</a>
            </div>
        </div>
    </div>-->

</div>


<script>
    var $replyBtnAudio = $('.reply-btn-audio');
    var $replyBtnWrap = $('.reply-btn-wrap');
    var $audioPublishDrop = $('.audio-publish-drop');
    var $audioPublishWrap = $('.audio-publish-wrap');


    $('.main-reply-inner input').focus(function () {
        canText();
    }).blur(function () {
        if ($(this).val() == 0) {
            canNotText();
        }
    });

    function canNotText() {
        $replyBtnAudio.show();
        $replyBtnWrap.hide();
    }
    function canText() {
        $replyBtnAudio.hide();
        $replyBtnWrap.show();
    }

    //录音
    $replyBtnAudio.click(function(){
        openAudioModel();
    });
    $('[data-toggle="close-audio-btn"]').click(function(){
        closeAudioModel();
    });

    function openAudioModel() {
        $audioPublishDrop.show();
        $audioPublishWrap.show();
    }
    function closeAudioModel() {
        $audioPublishDrop.hide();
        $audioPublishWrap.hide();
    }


    $('.show-all').click(function () {
        $(this).hide().prev('p').addClass('open');
    });

    //音频播放方法定义
    var nowPlayingEleAudio = false;//页面中是否存在正在播放的音频
    function livePlay(el) {
        var eleAudio = el.children("audio").get(0);//音频js对象
        var audioDuration = eleAudio.duration;//音频时长
        //动画字符串
        var transString = "transition-duration:" +
                audioDuration +
                "s;-webkit-transition-duration:" + audioDuration + "s";
        //播放时关闭其他音频
        if (nowPlayingEleAudio && nowPlayingEleAudio != eleAudio) {
            nowPlayingEleAudio.pause();
            nowPlayingEleAudio.currentTime = 0;
            $(nowPlayingEleAudio).siblings("i").attr("class", "iconfont icon-zanting1")
                    .closest(".ui-audio-bar").removeClass("playing")
                    .find(".audio-progress-inner").removeAttr("style");
        }


        if (eleAudio.paused) {  //如果暂停,则播放
            eleAudio.play();
            $(eleAudio).siblings("i").attr("class", "iconfont icon-bofang2")
                    .closest(".ui-audio-bar").addClass("playing")
                    .find(".audio-progress-inner").attr("style", transString);
            nowPlayingEleAudio = eleAudio;
        } else {  //如果播放,则暂停
            eleAudio.pause();
            eleAudio.currentTime = 0;
            $(eleAudio).siblings("i").attr("class", "iconfont icon-zanting1")
                    .closest(".ui-audio-bar").removeClass("playing")
                    .find(".audio-progress-inner").removeAttr("style");
            ;
        }

        //播放完毕时
        eleAudio.onended = function () {
            $(eleAudio).siblings("i").attr("class", "iconfont icon-zanting1")
                    .closest(".ui-audio-bar").removeClass("playing")
                    .find(".audio-progress-inner").removeAttr("style");
            ;//移除播放效果
        }
    }
    ;

    $("body").on("click", "[data-toggle='live-btn']", function () {
        livePlay($(this));//播放音频
    });
</script>
</body>
</html>