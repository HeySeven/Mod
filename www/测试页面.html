<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>参与人直播界面</title>
    <link rel="stylesheet" href="weui/weui.css">
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_nmfmi65bopskmx6r.css">
    <link rel="stylesheet" href="css/jquery-weui.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery.min.js"></script>
    <script src="plugins/adaptive-version2.js"></script>
    <script src="weui/weui.js"></script>
    <script src="plugins/jquery-weui.js"></script>
    <script src="plugins/audio.js"></script>
    <script src="js/main.js"></script>
</head>
<body>
<div class="container">
    <div class="live-page-wrap">
        <div class="live-page-header">
            <img src="images/author.jpg" alt="">
            <dl>
                <dt>韩春生</dt>
                <dd>直播时间：12月13日 20:00</dd>
            </dl>
            <p>提出情感相关问题，具体描述事情的前因后果和你的 困惑，精选优质导师帮你解答。提出情感相关问题，具体描述事情的前因后果和你的 困惑，精选优质导师帮你解答。 </p>
            <a class="show-all" href="javascript:;">查看完整简介</a>
        </div>
        <div class="live-page-yq">
            <a class="btn btn-danger" href="###">我的邀请卡</a>
        </div>
        <div class="live-content-body">
            <ul class="live-detail-wrap">
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                1、恭喜你成功进入直播间，留意
                                顶部的开播时间，就在此页面观看
                                直播哦~ <br>
                                2、听不到声音请往下翻，确认有
                                语音发出，手机没有静音；拔掉耳
                                机，关闭wifi后点击语音条重试：
                                再不行退出后重新进来。<br>
                                3、点击下方输入框提问讨论。
                                4、点击我的邀请卡生成专属邀请
                                卡将直播分享给好友。
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                大家好，我是你们的客服:Aurora。<br>
                                长按识别二维码，加我为好友。<br>
                                在使用墨多问答的过程中有任何文题都可以联系我。
                                <img class="live-ecode" src="images/live-ecode.png" alt="">
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                大家好，讲座马上开始了.
                            </div>
                        </div>
                    </div>
                </li>
                <audio preload="auto"></audio>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="ui-audio-bar">
                                <div class="ui-audio-progress">
                                    <div class="audio-progress-inner"></div>
                                </div>
                                <div class="ui-audio-data">
                                    <span>23″</span>
                                </div>
                                <a class="audio-btn" data-toggle="live-btn" data-src="images/636002265649091653.mp3"
                                   href="javascript:;">
                                    <i class="iconfont icon-zanting1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="ui-audio-bar no-play">
                                <div class="ui-audio-progress">
                                    <div class="audio-progress-inner"></div>
                                </div>
                                <div class="ui-audio-data">
                                    <span>23″</span>
                                </div>
                                <a class="audio-btn" data-toggle="live-btn" data-src="images/636002265649091653.mp3"
                                   href="javascript:;">
                                    <i class="iconfont icon-zanting1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="ui-audio-bar no-play">
                                <div class="ui-audio-progress">
                                    <div class="audio-progress-inner"></div>
                                </div>
                                <div class="ui-audio-data">
                                    <span>23″</span>
                                </div>
                                <a class="audio-btn" data-toggle="live-btn" data-src="images/636002265649091653.mp3"
                                   href="javascript:;">
                                    <i class="iconfont icon-zanting1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item">
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                    <div class="live-bd">
                        <div class="live-author-name">主讲人</div>
                        <div class="live-item-body">
                            <div class="ui-audio-bar no-play">
                                <div class="ui-audio-progress">
                                    <div class="audio-progress-inner"></div>
                                </div>
                                <div class="ui-audio-data">
                                    <span>23″</span>
                                </div>
                                <a class="audio-btn" data-toggle="live-btn" data-src="images/636002265649091653.mp3"
                                   href="javascript:;">
                                    <i class="iconfont icon-zanting1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="live-item my-live-item">
                    <div class="live-bd">
                        <div class="live-author-name">二虎子</div>
                        <div class="live-item-body">
                            <div class="live-text-box">
                                这个地方是听课人在提问提问的问 题显示在这里
                            </div>
                        </div>
                    </div>
                    <div class="live-hd">
                        <img src="images/author.jpg" alt="">
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="back-to-wrap">
    <a href="###" class="back-to-btn">回到播放位置</a>
</div>
<div class="fixed-control">
    <ul class="live-control-fixed">
        <li>
            <a href="###">
                <i class="iconfont icon-fenxiang1"></i>
                <span>分享</span>
            </a>
        </li>
        <li>
            <a href="###">
                <i class="iconfont icon-xianshiyezhikanlouzhu"></i>
                <span>只看主讲</span>
            </a>
        </li>
    </ul>
</div>
<div class="fix-btn-box ui-border-t">
    <div class="jia-reply" data-toggle="reply-btn">
        <div class="jia-reply-inner">
            <input type="text" placeholder="说点什么吧~">
        </div>
        <div class="reply-btn-wrap">
            <a href="###" class="reply-btn">发送</a>
        </div>
    </div>
</div>
<script>
    $(function () {
        function playStatus($this,duration) {
            $this.addClass("playing")
                    .children("i").attr("class", "iconfont icon-bofang2");
            var $progress = $this.siblings(".ui-audio-progress").children(".audio-progress-inner");
                $progress.css("width", "100%");
        }

        function stopStatus($this) {
            $this.removeClass("playing")
                    .children("i").attr("class", "iconfont icon-zanting1")
            $this.siblings(".ui-audio-progress")
                    .children(".audio-progress-inner").css("width", "0%");
        }

        audiojs.events.ready(function () {
            var a = audiojs.createAll({
                trackEnded: function() {
                    var $now = $("[data-toggle='live-btn'].playing");
                    var $next = $now.closest(".live-item")
                            .next(".live-item")
                            .find("[data-toggle='live-btn']");
                    stopStatus($now);
                    if ($next.length){
                        audio.load($next.attr('data-src'));
                        playStatus($next, audio.duration);
                        audio.play();
                    }
                }
            });
            var audio = a[0];
            first = $("[data-toggle='live-btn']").attr('data-src');
            audio.load(first);
            $("body").on("click", "[data-toggle='live-btn']", function (e) {
                var $this = $(this);
                e.preventDefault();
                //播放音频
                audio.load($this.attr('data-src'));
                if(!$this.hasClass("playing")){
                    audio.play();
                    var $nowPlay = $("[data-toggle='live-btn'].playing");
                    stopStatus($nowPlay);
                    playStatus($(this), audio.duration);
                    console.log(audio)
                }else{
                    audio.pause();
                    stopStatus($this);
                }

            });
        });
        // 回到播放位置
        $('.back-to-wrap').click(function(){
            var $nowPlayIng = $('[data-toggle="live-btn"].playing').closest('.live-item');
            $(window).scrollTop($nowPlayIng.offset().top);
        });
    });

</script>

</body>
</html>